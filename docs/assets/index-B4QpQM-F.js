const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-DwFQpxk1.js","assets/index-Bi8p9jWk.js","assets/pose-CfBJBx5o.js","assets/_commonjsHelpers-Cpj98o6Y.js","assets/camera_utils-DDupHUgx.js","assets/hands-DSkHx6hn.js","assets/selfie_segmentation-DaLfK2Le.js"])))=>i.map(i=>d[i]);
var Le=Object.defineProperty;var Ae=(e,t,n)=>t in e?Le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var K=(e,t,n)=>Ae(e,typeof t!="symbol"?t+"":t,n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const r of l.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function n(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(o){if(o.ep)return;o.ep=!0;const l=n(o);fetch(o.href,l)}})();function S(){}function we(e){return e()}function ue(){return Object.create(null)}function z(e){e.forEach(we)}function xe(e){return typeof e=="function"}function Z(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Oe(e){return Object.keys(e).length===0}function g(e,t){e.appendChild(t)}function v(e,t,n){e.insertBefore(t,n||null)}function _(e){e.parentNode&&e.parentNode.removeChild(e)}function Te(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function m(e){return document.createElement(e)}function Ee(e){return document.createTextNode(e)}function x(){return Ee(" ")}function Be(){return Ee("")}function ee(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function f(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function De(e){return Array.from(e.childNodes)}function X(e,t){e.value=t??""}function ce(e,t,n,i){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,"")}function de(e,t,n){for(let i=0;i<e.options.length;i+=1){const o=e.options[i];if(o.__value===t){o.selected=!0;return}}(!n||t!==void 0)&&(e.selectedIndex=-1)}function Fe(e){const t=e.querySelector(":checked");return t&&t.__value}function Me(e,t,{bubbles:n=!1,cancelable:i=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:i})}let H;function j(e){H=e}function $e(){if(!H)throw new Error("Function called outside component initialization");return H}function Ce(e){$e().$$.on_mount.push(e)}function Pe(){const e=$e();return(t,n,{cancelable:i=!1}={})=>{const o=e.$$.callbacks[t];if(o){const l=Me(t,n,{cancelable:i});return o.slice().forEach(r=>{r.call(e,l)}),!l.defaultPrevented}return!0}}const R=[],fe=[];let I=[];const me=[],Re=Promise.resolve();let Y=!1;function Ie(){Y||(Y=!0,Re.then(ke))}function q(e){I.push(e)}const Q=new Set;let M=0;function ke(){if(M!==0)return;const e=H;do{try{for(;M<R.length;){const t=R[M];M++,j(t),Ue(t.$$)}}catch(t){throw R.length=0,M=0,t}for(j(null),R.length=0,M=0;fe.length;)fe.pop()();for(let t=0;t<I.length;t+=1){const n=I[t];Q.has(n)||(Q.add(n),n())}I.length=0}while(R.length);for(;me.length;)me.pop()();Y=!1,Q.clear(),j(e)}function Ue(e){if(e.fragment!==null){e.update(),z(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(q)}}function je(e){const t=[],n=[];I.forEach(i=>e.indexOf(i)===-1?t.push(i):n.push(i)),n.forEach(i=>i()),I=t}const G=new Set;let O;function He(){O={r:0,c:[],p:O}}function Ne(){O.r||z(O.c),O=O.p}function N(e,t){e&&e.i&&(G.delete(e),e.i(t))}function J(e,t,n,i){if(e&&e.o){if(G.has(e))return;G.add(e),O.c.push(()=>{G.delete(e),i&&(n&&e.d(1),i())}),e.o(t)}else i&&i()}function pe(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Se(e){e&&e.c()}function te(e,t,n){const{fragment:i,after_update:o}=e.$$;i&&i.m(t,n),q(()=>{const l=e.$$.on_mount.map(we).filter(xe);e.$$.on_destroy?e.$$.on_destroy.push(...l):z(l),e.$$.on_mount=[]}),o.forEach(q)}function ne(e,t){const n=e.$$;n.fragment!==null&&(je(n.after_update),z(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ze(e,t){e.$$.dirty[0]===-1&&(R.push(e),Ie(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function ie(e,t,n,i,o,l,r=null,c=[-1]){const u=H;j(e);const s=e.$$={fragment:null,ctx:[],props:l,update:S,not_equal:o,bound:ue(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(u?u.$$.context:[])),callbacks:ue(),dirty:c,skip_bound:!1,root:t.target||u.$$.root};r&&r(s.root);let d=!1;if(s.ctx=n?n(e,t.props||{},(a,$,...b)=>{const y=b.length?b[0]:$;return s.ctx&&o(s.ctx[a],s.ctx[a]=y)&&(!s.skip_bound&&s.bound[a]&&s.bound[a](y),d&&ze(e,a)),$}):[],s.update(),d=!0,z(s.before_update),s.fragment=i?i(s.ctx):!1,t.target){if(t.hydrate){const a=De(t.target);s.fragment&&s.fragment.l(a),a.forEach(_)}else s.fragment&&s.fragment.c();t.intro&&N(e.$$.fragment),te(e,t.target,t.anchor),ke()}j(u)}class oe{constructor(){K(this,"$$");K(this,"$$set")}$destroy(){ne(this,1),this.$destroy=S}$on(t,n){if(!xe(n))return S;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const o=i.indexOf(n);o!==-1&&i.splice(o,1)}}$set(t){this.$$set&&!Oe(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Ve="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Ve);function he(e,t,n){const i=e.slice();return i[7]=t[n],i}function _e(e){let t;return{c(){t=m("div"),t.textContent="モバイルではCursorモード固定です",f(t,"class","text-gray-300 text-sm mt-2")},m(n,i){v(n,t,i)},d(n){n&&_(t)}}}function ve(e){let t,n,i,o,l,r,c,u,s,d,a;function $(){return e[5](e[7])}return{c(){t=m("li"),n=m("button"),i=m("div"),o=m("h3"),o.textContent=`${e[7].title}`,l=x(),r=m("p"),r.textContent=`${e[7].artist}`,c=x(),u=m("div"),u.textContent="プレイ",s=x(),f(o,"class","text-xl text-[#39C5BB] font-medium"),f(r,"class","text-white/70 text-sm"),f(u,"class","bg-[#39C5BB] text-white px-4 py-2 rounded-lg"),f(n,"class","w-full p-4 text-left flex justify-between items-center focus:outline-none"),f(t,"class","song-item bg-black/40 rounded-lg backdrop-blur-sm border border-[#39C5BB]/30")},m(b,y){v(b,t,y),g(t,n),g(n,i),g(i,o),g(i,l),g(i,r),g(n,c),g(n,u),g(t,s),d||(a=ee(n,"click",$),d=!0)},p(b,y){e=b},d(b){b&&_(t),d=!1,a()}}}function Ge(e){let t,n,i,o,l,r,c,u,s,d,a,$,b,y,L,w,p,T,B,D,se,le,V,U,W,re,k=e[1]&&_e(),F=pe(e[2]),C=[];for(let h=0;h<F.length;h+=1)C[h]=ve(he(e,F,h));return{c(){t=m("div"),n=x(),i=m("div"),o=x(),l=m("div"),r=x(),c=m("div"),u=x(),s=m("div"),d=m("div"),d.innerHTML='<h1 class="text-3xl xs:text-4xl sm:text-5xl md:text-6xl font-bold text-miku mb-2 tracking-wider">Lyric Stage</h1>',a=x(),$=m("div"),$.innerHTML='<p class="text-white/90 text-sm sm:text-base">歌詞の文字に触れてポイントを獲得しよう！</p>',b=x(),y=m("div"),L=m("label"),L.textContent="Playモード選択:",w=x(),p=m("select"),T=m("option"),T.textContent="Cursorモード",B=m("option"),B.textContent="Handモード",D=m("option"),D.textContent="Bodyモード",se=x(),k&&k.c(),le=x(),V=m("div"),U=m("ul");for(let h=0;h<C.length;h+=1)C[h].c();f(t,"id","stars-container"),f(t,"class","fixed top-0 left-0 w-full h-full z-0"),f(i,"class","spotlight left-1/4 hidden sm:block svelte-1fx20yu"),f(l,"class","spotlight left-2/4 hidden sm:block svelte-1fx20yu"),ce(l,"animation-delay","-3s"),f(c,"class","spotlight left-3/4 hidden sm:block svelte-1fx20yu"),ce(c,"animation-delay","-6s"),f(d,"class","text-center mb-4 sm:mb-6"),f($,"class","max-w-md mx-auto text-center mb-4 sm:mb-6 bg-black/30 p-2 sm:p-2 rounded-lg backdrop-blur-sm"),f(L,"for","game-mode"),f(L,"class","text-white mr-2 text-lg"),T.__value="cursor",X(T,T.__value),B.__value="hand",X(B,B.__value),D.__value="body",X(D,D.__value),f(p,"id","game-mode"),f(p,"class","p-2 rounded bg-gray-700 text-white text-lg"),p.disabled=e[1],e[0]===void 0&&q(()=>e[4].call(p)),f(y,"id","mode-selection"),f(y,"class","mt-4 mb-6 text-center"),f(U,"class","space-y-2 sm:space-y-3"),f(V,"class","max-w-lg w-full mx-auto"),f(s,"class","relative z-10 w-full max-w-xl flex flex-col items-center justify-center py-6 px-4 min-h-screen text-white")},m(h,P){v(h,t,P),v(h,n,P),v(h,i,P),v(h,o,P),v(h,l,P),v(h,r,P),v(h,c,P),v(h,u,P),v(h,s,P),g(s,d),g(s,a),g(s,$),g(s,b),g(s,y),g(y,L),g(y,w),g(y,p),g(p,T),g(p,B),g(p,D),de(p,e[0],!0),g(y,se),k&&k.m(y,null),g(s,le),g(s,V),g(V,U);for(let E=0;E<C.length;E+=1)C[E]&&C[E].m(U,null);W||(re=ee(p,"change",e[4]),W=!0)},p(h,[P]){if(P&2&&(p.disabled=h[1]),P&1&&de(p,h[0]),h[1]?k||(k=_e(),k.c(),k.m(y,null)):k&&(k.d(1),k=null),P&12){F=pe(h[2]);let E;for(E=0;E<F.length;E+=1){const ae=he(h,F,E);C[E]?C[E].p(ae,P):(C[E]=ve(ae),C[E].c(),C[E].m(U,null))}for(;E<C.length;E+=1)C[E].d(1);C.length=F.length}},i:S,o:S,d(h){h&&(_(t),_(n),_(i),_(o),_(l),_(r),_(c),_(u),_(s)),k&&k.d(),Te(C,h),W=!1,re()}}}function qe(){const e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),t="ontouchstart"in window||navigator.maxTouchPoints>0,n=window.innerWidth<=768,i=/iPhone|iPad|iPod/i.test(navigator.userAgent);return e||t&&n||i}function ge(){const e=document.getElementById("stars-container");if(!e)return;const t=Math.min(100,Math.floor(window.innerWidth*window.innerHeight/6e3));e.innerHTML="";const n=document.createDocumentFragment();for(let i=0;i<t;i++){const o=document.createElement("div");o.className="star",o.style.left=`${Math.random()*100}%`,o.style.top=`${Math.random()*100}%`,o.style.animationDelay=`${Math.random()*3}s`,Math.random()>.7&&(o.style.width="6px",o.style.height="6px",o.style.boxShadow="0 0 10px #fff"),n.appendChild(o)}e.appendChild(n)}function Je(e,t,n){const i=Pe(),o=[{id:1,title:"ストリートライト",artist:"加賀(ネギシャワーP)",apiToken:"HmfsoBVch26BmLCm",songUrl:"https://piapro.jp/t/ULcJ/20250205120202"},{id:2,title:"アリフレーション",artist:"雨良 Amala",apiToken:"rdja5JxMEtcYmyKP",songUrl:"https://piapro.jp/t/SuQO/20250127235813"},{id:3,title:"インフォーマルダイブ",artist:"99piano",apiToken:"CqbpJNJHwoGvXhlD",songUrl:"https://piapro.jp/t/Ppc9/20241224135843"},{id:4,title:"ハロー、フェルミ。",artist:"ど～ぱみん",apiToken:"o1B1ZygOqyhK5B3D",songUrl:"https://piapro.jp/t/oTaJ/20250204234235"},{id:5,title:"パレードレコード",artist:"きさら",apiToken:"G8MU8Wf87RotH8OR",songUrl:"https://piapro.jp/t/GCgy/20250202202635"},{id:6,title:"ロンリーラン",artist:"海風太陽",apiToken:"fI0SyBEEBzlB2f5C",songUrl:"https://piapro.jp/t/CyPO/20250128183915"}];let l="cursor",r=!1;function c(d){localStorage.setItem("selectedSong",JSON.stringify(d));const a=new URL(location.href);a.searchParams.set("page","game"),a.searchParams.set("mode",l),history.pushState({},"",a),i("startGame")}Ce(()=>{n(1,r=qe()),r&&n(0,l="cursor"),ge();let d;const a=()=>{clearTimeout(d),d=setTimeout(ge,250)};return window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)});function u(){l=Fe(this),n(0,l)}return[l,r,o,c,u,d=>c(d)]}class We extends oe{constructor(t){super(),ie(this,t,Je,Ge,Z,{})}}const Ke="modulepreload",Xe=function(e){return"/star/"+e},be={},A=function(t,n,i){let o=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const r=document.querySelector("meta[property=csp-nonce]"),c=(r==null?void 0:r.nonce)||(r==null?void 0:r.getAttribute("nonce"));o=Promise.allSettled(n.map(u=>{if(u=Xe(u),u in be)return;be[u]=!0;const s=u.endsWith(".css"),d=s?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${d}`))return;const a=document.createElement("link");if(a.rel=s?"stylesheet":Ke,s||(a.as="script"),a.crossOrigin="",a.href=u,c&&a.setAttribute("nonce",c),document.head.appendChild(a),s)return new Promise(($,b)=>{a.addEventListener("load",$),a.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${u}`)))})}))}function l(r){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=r,window.dispatchEvent(c),!c.defaultPrevented)throw r}return o.then(r=>{for(const c of r||[])c.status==="rejected"&&l(c.reason);return t().catch(l)})};function Qe(e){let t,n,i,o,l,r,c,u,s,d,a,$,b,y,L;return{c(){t=m("button"),t.textContent="← タイトルへ",n=x(),i=m("video"),o=x(),l=m("canvas"),r=x(),c=m("div"),c.innerHTML='<span id="countdown-text" class="text-white text-9xl font-bold"></span>',u=x(),s=m("div"),s.innerHTML='<div id="stage-area" class="absolute top-0 left-0 w-full h-3/5 bg-gray-900 overflow-hidden flex justify-center items-end"><div class="w-full h-1/4 bg-black/30" style="perspective: 50px;"><div class="w-full h-full bg-gray-700" style="transform: rotateX(30deg);"></div></div> <div class="absolute bottom-0 left-1/2 -translate-x-1/2 w-[200%] h-[200px] bg-gradient-to-t from-purple-600/30 to-transparent rounded-[100%] animate-pulse"></div> <div class="absolute bottom-0 left-1/2 -translate-x-1/2 w-[150%] h-[150px] bg-gradient-to-t from-blue-500/40 to-transparent rounded-[100%]" style="animation-delay: 500ms;"></div></div> <div id="audience-area" class="absolute bottom-0 left-0 w-full h-2/5"></div>',d=x(),a=m("div"),a.innerHTML='<div id="miku"></div> <div id="song-info"><div id="song-title">Lyricほにゃらら</div> <div id="loading">ゲームをロード中...</div></div> <div id="score-container"><div id="score">0</div> <div id="combo">コンボ: 0</div></div> <div id="instructions">歌詞の文字にマウスを当ててポイントを獲得しよう！</div> <div id="controls"><button id="play-pause" aria-label="再生/一時停止">再生</button> <button id="restart" aria-label="最初から">最初から</button></div>',$=x(),b=m("div"),b.innerHTML='<div class="results-container"><h2>リザルト</h2> <div class="results-content"><div class="results-score-section"><div id="final-score-display">0</div> <div id="final-combo-display">最大コンボ: 0</div> <div id="rank-display">ランク: S</div></div></div> <div class="results-buttons"><button id="back-to-title">タイトルへ戻る</button> <button id="replay-song">もう一度プレイ</button></div></div>',f(t,"class","fixed top-3 left-3 z-[2000] bg-gray-800/80 text-white px-4 py-2 rounded"),f(i,"id","camera-video"),f(i,"class","hidden"),f(l,"id","segmentation-canvas"),f(l,"class","fixed top-0 left-0 w-full h-full z-[1]"),f(c,"id","countdown-overlay"),f(c,"class","fixed top-0 left-0 w-full h-full flex justify-center items-center bg-black bg-opacity-70 z-[1000] hidden"),f(s,"id","live-background"),f(s,"class","fixed top-0 left-0 w-full h-full z-[-1]"),f(a,"id","game-container"),f(b,"id","results-screen"),f(b,"class","hidden")},m(w,p){v(w,t,p),v(w,n,p),v(w,i,p),v(w,o,p),v(w,l,p),v(w,r,p),v(w,c,p),v(w,u,p),v(w,s,p),v(w,d,p),v(w,a,p),v(w,$,p),v(w,b,p),y||(L=ee(t,"click",e[1]),y=!0)},p:S,i:S,o:S,d(w){w&&(_(t),_(n),_(i),_(o),_(l),_(r),_(c),_(u),_(s),_(d),_(a),_($),_(b)),y=!1,L()}}}function ye(e){return new Promise((t,n)=>{const i=document.createElement("script");i.src=e,i.async=!0,i.onload=()=>t(),i.onerror=()=>n(new Error(`Failed to load ${e}`)),document.body.appendChild(i)})}function Ye(e){const t=Pe();return Ce(async()=>{new URLSearchParams(location.search);try{const i="/star/";if(window.__BASE_URL=i,!document.getElementById("game-styles-link")){const a=document.createElement("link");a.id="game-styles-link",a.rel="stylesheet",a.href=`${i}styles.css`,document.head.appendChild(a)}const[o,l,r,c,u,s,d]=await Promise.all([A(()=>import("./index.es-DwFQpxk1.js"),__vite__mapDeps([0,1])),A(()=>import("./three.module-DbmfBPKn.js"),[]),A(()=>import("./pose-CfBJBx5o.js").then(a=>a.p),__vite__mapDeps([2,3])),A(()=>import("./camera_utils-DDupHUgx.js").then(a=>a.c),__vite__mapDeps([4,3])),A(()=>import("./hands-DSkHx6hn.js").then(a=>a.h),__vite__mapDeps([5,3])).catch(()=>({Hands:void 0})),A(()=>import("./selfie_segmentation-DaLfK2Le.js").then(a=>a.s),__vite__mapDeps([6,3])),A(()=>import("./index-Bi8p9jWk.js"),[])]);window.TextAliveApp={Player:o.Player},window.THREE=l,window.Pose=r.Pose,window.POSE_CONNECTIONS=r.POSE_CONNECTIONS,window.Camera=c.Camera,u.Hands&&(window.Hands=u.Hands),window.SelfieSegmentation=s.SelfieSegmentation,window.axios=d.default||d,await ye(`${i}script.js`),await ye(`${i}game-loader.js`)}catch(i){console.error(i)}}),[t,()=>t("back")]}class Ze extends oe{constructor(t){super(),ie(this,t,Ye,Qe,Z,{})}}function et(e){let t,n;return t=new Ze({}),t.$on("back",e[3]),{c(){Se(t.$$.fragment)},m(i,o){te(t,i,o),n=!0},p:S,i(i){n||(N(t.$$.fragment,i),n=!0)},o(i){J(t.$$.fragment,i),n=!1},d(i){ne(t,i)}}}function tt(e){let t,n;return t=new We({}),t.$on("startGame",e[2]),{c(){Se(t.$$.fragment)},m(i,o){te(t,i,o),n=!0},p:S,i(i){n||(N(t.$$.fragment,i),n=!0)},o(i){J(t.$$.fragment,i),n=!1},d(i){ne(t,i)}}}function nt(e){let t,n,i,o;const l=[tt,et],r=[];function c(u,s){return u[0]==="index"?0:1}return t=c(e),n=r[t]=l[t](e),{c(){n.c(),i=Be()},m(u,s){r[t].m(u,s),v(u,i,s),o=!0},p(u,[s]){let d=t;t=c(u),t===d?r[t].p(u,s):(He(),J(r[d],1,1,()=>{r[d]=null}),Ne(),n=r[t],n?n.p(u,s):(n=r[t]=l[t](u),n.c()),N(n,1),n.m(i.parentNode,i))},i(u){o||(N(n),o=!0)},o(u){J(n),o=!1},d(u){u&&_(i),r[t].d(u)}}}function it(e,t,n){let i="index";i=new URLSearchParams(location.search).get("page")==="game"?"game":"index";function l(s){const d=new URL(location.href);s==="game"?d.searchParams.set("page","game"):d.searchParams.delete("page"),history.pushState({},"",d),n(0,i=s)}const r=()=>{const s=new URLSearchParams(location.search).get("page");n(0,i=s==="game"?"game":"index")};return window.addEventListener("popstate",r),[i,l,()=>l("game"),()=>l("index")]}class ot extends oe{constructor(t){super(),ie(this,t,it,nt,Z,{})}}new ot({target:document.getElementById("app")});export{A as _};
