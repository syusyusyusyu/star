# Lyricほにゃらら

## プロジェクト概要
このプロジェクトは、歌詞を表示して触れるリズムゲームです。TextAlive Player を使用して歌詞のタイミングを音楽と同期させますが、API が利用できない場合はフォールバックモードで動作します。Three.js を使用したライブステージのビジュアルと、MediaPipe Pose を使用したカメラベースのインタラクション（ペンライトの動きなど）が特徴です。

## セットアップと実行方法

### 1. ファイルの配置
プロジェクトのすべてのファイル（`game-loader.js`, `game.html`, `index-scripts.js`, `index-styles.css`, `index.html`, `script.js`, `styles.css`）を任意のディレクトリに配置します。

### 2. 依存関係
このプロジェクトは、外部ライブラリとして TextAlive Player, Three.js, MediaPipe Pose を CDN 経由で利用しています。特別なインストール作業は不要です。

### 3. 実行
`index.html` をウェブブラウザで開いてください。

```bash
# 例: Linux環境でPythonの簡易HTTPサーバーを使用する場合
python3 -m http.server 8000
# その後、ブラウザで http://localhost:8000/index.html にアクセス
```

## 遊び方
1.  `index.html` を開くと、ゲームのタイトル画面が表示されます。
2.  プレイモード（カーソルモード、ハンドモード、ボディモード）を選択します。
3.  曲を選択し、「プレイ」ボタンをクリックしてゲーム画面へ進みます。
4.  「再生」ボタンをクリックすると音楽が開始され、歌詞が画面に表示されます。
    *   **ボディモードの場合**: 全身がカメラに映っていることを確認後、5秒のカウントダウンが始まり、その後ゲームが開始されます。ゲーム中に全身が画面から3秒外れると警告が表示されます。
5.  表示された歌詞をマウスでクリックするか、指でタップ、または体で触れてください。
6.  歌詞をヒットするとスコアが加算され、コンボが繋がります。
7.  **画面から消えるまでにヒットできなかった歌詞があると、コンボがリセットされます。**
8.  曲の終了後、リザルト画面が表示され、最終スコアとランクが確認できます。

## プロジェクト構造
-   `index.html`: ゲームのタイトル画面、モード選択、曲選択画面。
-   `game.html`: メインのゲーム画面。
-   `script.js`: ゲームの主要なロジック（歌詞の表示、クリック判定、スコア・コンボ管理、TextAlive Player との連携、Three.js および MediaPipe Pose の統合、モード管理、全身検出とカウントダウン）が含まれています。
-   `game-loader.js`: ゲームのロードと初期化に関するスクリプト。
-   `styles.css`: ゲーム全体の基本的なスタイル。
-   `index-styles.css`: タイトル画面のスタイル。
-   `index-scripts.js`: タイトル画面のスクリプトとモード選択の連携。

## 使用技術
-   **HTML5**: ゲームの構造。
-   **CSS3**: スタイリング。
-   **JavaScript (ES6+)**: ゲームロジック。
-   **TextAlive Player**: 歌詞と音楽の同期。
-   **Three.js**: 3Dグラフィックス（ライブステージのビジュアル、ペンライトなど）。
-   **MediaPipe Pose**: カメラからのポーズ推定によるインタラクション（CPU処理に最適化）。
-   **MediaPipe Hands**: カメラからの手検出によるインタラクション（CPU処理に最適化）。
-   **MediaPipe Selfie Segmentation**: 背景除去（CPU処理に最適化）。